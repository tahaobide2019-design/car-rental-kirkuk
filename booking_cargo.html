<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø·Ù„Ø¨ Ù†Ù‚Ù„ Ø­Ù…Ù„ | Ø§Ù„Ø­ÙˆØª ğŸ‹</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        body { font-family: 'Tajawal', sans-serif; background-color: #F8F9FD; }
        .hero-section { background: linear-gradient(180deg, #6366F1 0%, #4F46E5 100%); border-radius: 0 0 3rem 3rem; }
        
        /* Ø³ØªØ§ÙŠÙ„ Ø§Ù„Ø®Ø§Ù†Ø§Øª Ø§Ù„Ù…Ù‚ØªØ¨Ø³ Ù…Ù† Ø§Ù„ØµÙˆØ±Ø© */
        .input-card {
            background: white;
            border: 2px solid #FFD700; /* Ø§Ù„Ø¥Ø·Ø§Ø± Ø§Ù„Ø°Ù‡Ø¨ÙŠ */
            border-radius: 1.5rem;
            padding: 1rem;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
            transition: 0.3s;
        }
        .input-label { color: #94a3b8; font-size: 0.8rem; font-weight: 800; margin-bottom: 5px; display: block; }
        .input-field { width: 100%; border: none; outline: none; font-weight: 900; color: #1e1b4b; font-size: 1rem; }

        .map-container { background: #EEF2FF; border-radius: 2.5rem; padding: 1.5rem; margin-top: 1.5rem; }
        .map-box { height: 200px; border-radius: 1.5rem; border: 3px solid white; margin-bottom: 10px; z-index: 1; }
        
        .btn-location { background: #6366F1; color: white; padding: 10px 20px; border-radius: 1rem; font-weight: 800; font-size: 0.8rem; width: 100%; }
        .btn-main { background: #6366F1; color: white; padding: 1.2rem; border-radius: 1.5rem; font-weight: 900; font-size: 1.2rem; width: 100%; box-shadow: 0 10px 20px rgba(99, 102, 241, 0.3); }
    </style>
</head>
<body>

    <header class="hero-section text-white pt-10 pb-20 text-center relative">
        <img src="https://cdn-icons-png.flaticon.com/512/411/411763.png" class="w-20 mx-auto mb-4" alt="truck">
        <h1 class="text-3xl font-black italic">ØªØ£ÙƒÙŠØ¯ Ø·Ù„Ø¨ Ø§Ù„Ø´Ø­Ù†</h1>
        <p class="opacity-80 text-sm mt-2">Ø­Ø¯Ø¯ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù†Ù‚Ù„ Ø¨Ø¯Ù‚Ø© Ù„Ù…Ø³Ø§Ø¹Ø¯ØªÙ†Ø§ ÙÙŠ Ø®Ø¯Ù…ØªÙƒ</p>
    </header>

    <main class="container mx-auto px-6 -mt-12 pb-20">
        <div class="grid grid-cols-2 gap-4 mb-8">
            <div class="input-card">
                <label class="input-label">ğŸ‘¤ Ø§Ø³Ù… Ø§Ù„Ù…ØªØ¯Ø±Ø¨ (Ø§Ù„Ø²Ø¨ÙˆÙ†)</label>
                <input type="text" id="custName" placeholder="Ø£ÙƒØªØ¨ Ù‡Ù†Ø§.." class="input-field">
            </div>
            <div class="input-card">
                <label class="input-label">ğŸ“ Ø±Ù‚Ù… (ÙˆØ§ØªØ³Ø§Ø¨)</label>
                <input type="tel" id="custPhone" placeholder="077..." class="input-field text-left" dir="ltr">
            </div>
        </div>

        <div class="input-card mb-8" style="border-color: #E2E8F0;">
            <label class="input-label">ğŸ“¦ Ù…Ø§Ø°Ø§ Ø³ØªÙ†Ù‚Ù„ØŸ (Ø£Ùˆ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©)</label>
            <input type="text" id="cargoNotes" placeholder="Ù…Ø«Ù„Ø§Ù‹: Ø£Ø«Ø§Ø« Ù…Ù†Ø²Ù„ØŒ Ø¨Ø¶Ø§Ø¹Ø©.." class="input-field">
        </div>

        <div class="map-container">
            <h3 class="font-black text-indigo-900 mb-4 flex items-center gap-2">
                <i class="fas fa-arrow-up text-green-500"></i> ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… (Ù…Ù†ÙŠÙ†ØŸ)
            </h3>
            <div id="mapStart" class="map-box"></div>
            <button onclick="getLocation('start')" class="btn-location">ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹ÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠ ğŸ›°ï¸</button>
        </div>

        <div class="map-container">
            <h3 class="font-black text-indigo-900 mb-4 flex items-center gap-2">
                <i class="fas fa-arrow-down text-red-500"></i> ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹ Ø§Ù„ØªØ³Ù„ÙŠÙ… (Ù„ÙˆÙŠÙ†ØŸ)
            </h3>
            <div id="mapEnd" class="map-box"></div>
            <button onclick="getLocation('end')" class="btn-location">ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙˆØ¬Ù‡Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© ğŸ›°ï¸</button>
        </div>

        <div class="mt-10">
            <button onclick="confirmCargoOrder()" class="btn-main flex items-center justify-center gap-3">
                Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª <i class="fas fa-chevron-left"></i>
            </button>
        </div>
    </main>

    <script>
        let mapStart, markerStart, mapEnd, markerEnd;
        const u = new URLSearchParams(window.location.search);

        window.onload = function() {
            // ØªÙ‡ÙŠØ¦Ø© Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ø§Ù†Ø·Ù„Ø§Ù‚
            mapStart = L.map('mapStart', {zoomControl: false}).setView([35.4687, 44.3921], 12);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(mapStart);
            markerStart = L.marker([35.4687, 44.3921], {draggable: true}).addTo(mapStart);

            // ØªÙ‡ÙŠØ¦Ø© Ø®Ø±ÙŠØ·Ø© Ø§Ù„ØªØ³Ù„ÙŠÙ…
            mapEnd = L.map('mapEnd', {zoomControl: false}).setView([35.4687, 44.3921], 12);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(mapEnd);
            markerEnd = L.marker([35.4687, 44.3921], {draggable: true}).addTo(mapEnd);
        };

        function getLocation(type) {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(pos => {
                    const c = [pos.coords.latitude, pos.coords.longitude];
                    if(type === 'start') {
                        mapStart.setView(c, 16); markerStart.setLatLng(c);
                    } else {
                        mapEnd.setView(c, 16); markerEnd.setLatLng(c);
                    }
                });
            }
        }

        function confirmCargoOrder() {
            const name = document.getElementById('custName').value;
            const phone = document.getElementById('custPhone').value;
            const notes = document.getElementById('cargoNotes').value;
            
            if(!name || !phone) return alert("ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø£ÙˆÙ„Ø§Ù‹ ğŸ‹");

            u.set('name', name);
            u.set('phone', phone);
            u.set('cargo_notes', notes);
            u.set('slat', markerStart.getLatLng().lat); u.set('slng', markerStart.getLatLng().lng);
            u.set('elat', markerEnd.getLatLng().lat); u.set('elng', markerEnd.getLatLng().lng);

            window.location.href = `review.html?${u.toString()}`;
        }
    </script>
</body>
</html>
