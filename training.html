            const l = translations[currentLang] || translations['ar'];
            document.getElementById('htmlTag').dir = l.dir;
            document.getElementById('pageTitle').innerText = l.title;
            document.getElementById('lblMap').innerHTML = `<i class="fas fa-search dynamic-text"></i> ${l.map}`;
            document.getElementById('btnGPS').innerText = l.gps;
            document.getElementById('btnSubmitText').innerText = l.submit;
            
            const cityParam = p.get('city') || '---';
            const dateParam = p.get('date') || '---';
            document.getElementById('summary').innerHTML = `ğŸ“ ${l.city}: ${cityParam} | ğŸ“… ${l.date}: ${dateParam}`;
        }

        function setGender(g) {
            selectedGender = g;
            const root = document.documentElement;
            if(g === 'Female') {
                root.style.setProperty('--main-color', '#db2777');
                document.getElementById('femaleBtn').classList.add('active');
                document.getElementById('maleBtn').classList.remove('active');
            } else {
                root.style.setProperty('--main-color', '#7c3aed');
                document.getElementById('maleBtn').classList.add('active');
                document.getElementById('femaleBtn').classList.remove('active');
            }
        }

        function getGPS() {
            if (!navigator.geolocation) return;
            navigator.geolocation.getCurrentPosition(pos => {
                const coords = [pos.coords.latitude, pos.coords.longitude];
                map.setView(coords, 17); marker.setLatLng(coords);
            });
        }

        function goToReviewTraining() {
            const name = document.getElementById('tName').value;
            const phone = document.getElementById('tPhone').value;
            const nationalID = document.getElementById('tNationalID').value;
            const age = document.getElementById('tAge').value;
            const latlng = marker.getLatLng();

            if(!name || !phone || !nationalID || !age) { 
                alert(translations[currentLang].alert); 
                return; 
            }
            
            // ØªØµØ­ÙŠØ­ Ø±Ø§Ø¨Ø· Ø§Ù„Ø®Ø±ÙŠØ·Ø©
            const googleMapsLink = `https://www.google.com/maps?q=${latlng.lat},${latlng.lng}`;
            
            const params = new URLSearchParams();
            params.set('lang', currentLang);
            params.set('province', p.get('city') || ''); // Ù†Ø³ØªØ®Ø¯Ù… province Ù„ØªÙˆØ§ÙÙ‚ Ø§Ù„Ø³ÙƒØ±ÙŠØ¨Øª
            params.set('service', 'ÙƒÙˆØ±Ø³ ØªØ¹Ù„ÙŠÙ… Ù‚ÙŠØ§Ø¯Ø©');
            params.set('name', name);
            params.set('phone', phone);
            params.set('id_no', nationalID); // ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ø¹Ø±Ù Ù„ÙŠØªÙˆØ§ÙÙ‚ Ù…Ø¹ review.html
            params.set('age', age);
            params.set('gender', selectedGender === 'Male' ? 'Ø°ÙƒØ±' : 'Ø£Ù†Ø«Ù‰');
            params.set('map', googleMapsLink);
            params.set('car', 'ÙƒÙˆØ±Ø³ ØªØ¯Ø±ÙŠØ¨');
            params.set('price', 'Ø­Ø³Ø¨ Ø§Ù„Ø§ØªÙØ§Ù‚'); // ÙƒÙˆØ±Ø³ Ø§Ù„ØªØ¹Ù„ÙŠÙ… Ø¹Ø§Ø¯Ø© Ù„ÙŠØ³ Ù„Ù‡ Ø³Ø¹Ø± Ø«Ø§Ø¨Øª Ø¨Ø§Ù„Ø±Ø§Ø¯Ø§Ø¯Ø±

            window.location.href = `review.html?${params.toString()}`;
        }
    </script>
</body>
</html>
