<!DOCTYPE html>
<html lang="ar" dir="rtl" id="htmlTag">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ£Ø¬Ø± | Ø§Ù„Ø­ÙˆØª ğŸ‹</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        body { font-family: 'Tajawal', sans-serif; background-color: #f7f9fc; color: #444; }
        
        /* Ø§Ù„Ø¥Ø·Ø§Ø± Ø§Ù„Ø¹Ù„ÙˆÙŠ Ø§Ù„Ù…Ù„ÙˆÙ† Ø§Ù„Ù…ØªÙƒÙŠÙ Ù…Ø¹ Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© */
        .header-curve {
            height: 180px;
            background: #6366f1; /* Ù„ÙˆÙ† Ø§ÙØªØ±Ø§Ø¶ÙŠ */
            border-bottom-left-radius: 50% 20%;
            border-bottom-right-radius: 50% 20%;
            position: relative;
            transition: 1s;
        }

        /* Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
        .main-container {
            max-width: 450px;
            margin: -100px auto 40px;
            padding: 0 20px;
        }

        /* ÙƒØ±Øª Ø§Ù„Ù…Ù„Ø®Øµ Ø§Ù„Ø¹Ù„ÙˆÙŠ (Ù…Ø«Ù„ Ø§Ù„ØµÙˆØ±Ø©) */
        .info-card {
            background: #fffcf2;
            border-radius: 1.5rem;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            margin-bottom: 30px;
            border: 1px solid #fef3c7;
        }

        .summary-line {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            font-size: 0.9rem;
            font-weight: 700;
            color: #6366f1;
        }

        /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø­Ù‚ÙˆÙ„ (Ù…Ø·Ø§Ø¨Ù‚ Ù„Ù„ØµÙˆØ±Ø© ØªÙ…Ø§Ù…Ø§Ù‹) */
        .input-group { margin-bottom: 20px; }
        .label-style {
            display: block;
            font-weight: 700;
            color: #888;
            font-size: 0.85rem;
            margin-bottom: 8px;
            margin-right: 15px;
        }
        .custom-input {
            width: 100%;
            padding: 18px 25px;
            background: #fff;
            border: 2px solid #e2e8f0;
            border-radius: 2rem;
            font-size: 1.1rem;
            font-weight: 700;
            color: #444;
            outline: none;
            transition: 0.3s;
            text-align: center;
        }
        .custom-input:focus { border-color: #6366f1; background: #fff; }
        .custom-input::placeholder { color: #cbd5e1; }

        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¬Ù†Ø³ (Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„Ù„ØµÙˆØ±Ø©) */
        .gender-container { display: flex; gap: 15px; }
        .gender-option {
            flex: 1;
            padding: 15px;
            background: #fff;
            border: 2px solid #e2e8f0;
            border-radius: 1.5rem;
            font-weight: 900;
            text-align: center;
            cursor: pointer;
            transition: 0.3s;
            font-size: 1.1rem;
        }
        .gender-option.active {
            background: #6366f1; /* Ø³ÙŠØªØºÙŠØ± Ø­Ø³Ø¨ Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© */
            color: white;
            border-color: #6366f1;
        }

        #map { height: 200px; border-radius: 2rem; margin-top: 15px; border: 2px solid #e2e8f0; }
        
        .btn-submit {
            width: 100%;
            padding: 20px;
            background: #6366f1;
            color: white;
            border-radius: 2rem;
            font-weight: 900;
            font-size: 1.2rem;
            margin-top: 30px;
            box-shadow: 0 10px 20px rgba(99, 102, 241, 0.2);
        }
    </style>
</head>
<body>

    <div id="headerColor" class="header-curve flex justify-center pt-8 text-white">
        <div class="text-center">
            <div id="serviceIcon" class="text-5xl mb-2">ğŸ“</div>
            <h2 id="serviceName" class="text-3xl font-black">---</h2>
        </div>
    </div>

    <main class="main-container">
        <div class="info-card">
            <div class="summary-line">
                <span id="displayCity">ğŸ“ Ø¨ØºØ¯Ø§Ø¯</span> | 
                <span id="displayDate">ğŸ“… 2026-02-01</span> | 
                <span id="displayService">ğŸ“ ØªØ¹Ù„ÙŠÙ… Ù‚ÙŠØ§Ø¯Ø©</span>
            </div>
            <div class="text-xl font-black mt-2 text-amber-600">ğŸ’° <span id="displayPrice">0</span> Ø¯.Ø¹</div>
        </div>

        <div class="input-group">
            <label class="label-style">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ£Ø¬Ø±</label>
            <input type="text" id="custName" class="custom-input" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„">
        </div>

        <div class="grid grid-cols-2 gap-4 mb-5">
            <div>
                <label class="label-style">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
                <input type="tel" id="custPhone" class="custom-input" placeholder="07xx xxx xxxx">
            </div>
            <div>
                <label class="label-style">Ø§Ù„Ø¹Ù…Ø±</label>
                <input type="number" id="custAge" class="custom-input" placeholder="25">
            </div>
        </div>

        <div class="input-group">
            <label class="label-style">Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ© / Ø§Ù„Ø¬ÙˆØ§Ø²</label>
            <input type="text" id="idNumber" class="custom-input" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ© Ø£Ùˆ Ø§Ù„Ø¬ÙˆØ§Ø²">
        </div>

        <div class="input-group">
            <label class="label-style">Ø¬Ù†Ø³ Ø§Ù„Ù…Ø³ØªØ£Ø¬Ø±</label>
            <div class="gender-container">
                <div id="maleBtn" onclick="setGender('Male')" class="gender-option active">Ø°ÙƒØ± ğŸ‘¦</div>
                <div id="femaleBtn" onclick="setGender('Female')" class="gender-option">Ø£Ù†Ø«Ù‰ ğŸ‘©</div>
            </div>
        </div>

        <div class="input-group">
            <label class="label-style">Ù…ÙˆÙ‚Ø¹ Ø§Ù„ØªØ³Ù„ÙŠÙ…</label>
            <div id="map"></div>
        </div>

        <button onclick="confirmBooking()" id="submitBtn" class="btn-submit">
            Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ
        </button>
    </main>

    <script>
        const u = new URLSearchParams(window.location.search);
        const city = u.get('city') || 'ÙƒØ±ÙƒÙˆÙƒ';
        const type = u.get('type') || 'personal';
        let selectedGender = 'Male';

        // Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„Ù…Ø¯Ù†
        const styleColor = { 
            'ÙƒØ±ÙƒÙˆÙƒ': '#0d9488', 'Ø¨ØºØ¯Ø§Ø¯': '#6366f1', 'Ø£Ø±Ø¨ÙŠÙ„': '#16a34a', 
            'Ø§Ù„Ø³Ù„ÙŠÙ…Ø§Ù†ÙŠØ©': '#9333ea', 'Ø§Ù„Ù…ÙˆØµÙ„': '#854d0e', 'Ø§Ù„Ø¨ØµØ±Ø©': '#0284c7' 
        };

        const serviceData = {
            'personal': { name: 'ØªØ£Ø¬ÙŠØ± Ø´Ø®ØµÙŠ', icon: 'ğŸš—' },
            'wedding': { name: 'Ø³ÙŠØ§Ø±Ø© Ø£Ø¹Ø±Ø§Ø³', icon: 'ğŸ' },
            'training': { name: 'ÙƒÙˆØ±Ø³ ØªØ¹Ù„ÙŠÙ… Ù‚ÙŠØ§Ø¯Ø©', icon: 'ğŸ“' }
        };

        window.onload = function() {
            const color = styleColor[city] || '#6366f1';
            const srv = serviceData[type] || serviceData['personal'];

            // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù„ÙˆÙ† Ø¹Ù„Ù‰ Ø§Ù„Ù‡ÙŠØ¯Ø± ÙˆØ§Ù„Ø£Ø²Ø±Ø§Ø±
            document.getElementById('headerColor').style.backgroundColor = color;
            document.getElementById('submitBtn').style.backgroundColor = color;
            window.cityMainColor = color; // Ù„Ø­ÙØ¸ Ø§Ù„Ù„ÙˆÙ† ÙˆØ§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ ÙÙŠ Ø²Ø± Ø§Ù„Ø¬Ù†Ø³

            // ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            document.getElementById('serviceName').innerText = srv.name;
            document.getElementById('serviceIcon').innerText = srv.icon;
            document.getElementById('displayCity').innerText = `ğŸ“ ${city}`;
            document.getElementById('displayService').innerText = `${srv.icon} ${srv.name}`;
            document.getElementById('displayPrice').innerText = parseInt(u.get('price') || 0).toLocaleString();
            document.getElementById('displayDate').innerText = `ğŸ“… ${new Date().toISOString().split('T')[0]}`;

            // Ø§Ù„Ø®Ø±ÙŠØ·Ø©
            const map = L.map('map').setView([33.3152, 44.3661], 12);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
            L.marker([33.3152, 44.3661], {draggable: true}).addTo(map);

            updateGenderUI();
        };

        function setGender(g) {
            selectedGender = g;
            updateGenderUI();
        }

        function updateGenderUI() {
            const male = document.getElementById('maleBtn');
            const female = document.getElementById('femaleBtn');
            const color = window.cityMainColor || '#6366f1';

            [male, female].forEach(btn => {
                btn.classList.remove('active');
                btn.style.backgroundColor = 'white';
                btn.style.color = '#444';
                btn.style.borderColor = '#e2e8f0';
            });

            const activeBtn = selectedGender === 'Male' ? male : female;
            activeBtn.classList.add('active');
            activeBtn.style.backgroundColor = color;
            activeBtn.style.borderColor = color;
            activeBtn.style.color = 'white';
        }

        function confirmBooking() {
            const name = document.getElementById('custName').value;
            const phone = document.getElementById('custPhone').value;
            if(!name || !phone) { alert('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©'); return; }
            
            u.set('name', name);
            u.set('phone', phone);
            u.set('gender', selectedGender);
            window.location.href = `review.html?${u.toString()}`;
        }
    </script>
</body>
</html>
