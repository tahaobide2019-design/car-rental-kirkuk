<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ØªØ®ØµÙŠØµ Ø§Ù„Ø±ÙØ§Ù‡ÙŠØ© | Ø§Ù„Ø­ÙˆØª ğŸ‹</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { --main: #002349; --accent: #D4AF37; --soft: #f8fafc; }
        body { font-family: 'Tajawal', sans-serif; background-color: var(--soft); overflow-x: hidden; }
        
        /* ØªØµÙ…ÙŠÙ… Ø§Ù„Ù‡ÙŠØ¯Ø± Ù„ÙŠÙƒÙˆÙ† Ù…ØªØ·Ø§Ø¨Ù‚Ø§Ù‹ Ù…Ø¹ Ù…Ù„Ù Ø§Ù„ØªØ¯Ø±ÙŠØ¨ */
        .hero-box { background: var(--main); border-radius: 0 0 4rem 4rem; position: relative; }
        .hero-box::after { content: 'ğŸ‹'; position: absolute; bottom: -20px; left: 50%; transform: translateX(-50%); font-size: 2.5rem; background: white; border-radius: 50%; padding: 10px; box-shadow: 0 10px 20px rgba(0,0,0,0.1); }

        /* Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ§Øª Ø§Ù„Ù…Ø§Ø±ÙƒØ© */
        .addon-card { 
            background: white; border-radius: 2.5rem; transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border: 3px solid transparent; cursor: pointer; position: relative;
        }
        .addon-card.selected { 
            border-color: var(--accent); transform: scale(1.02);
            box-shadow: 0 20px 40px rgba(212, 175, 55, 0.15);
        }
        .addon-card.selected .check-box { background: var(--accent); color: white; }
        
        .check-box { 
            width: 30px; height: 30px; border-radius: 50%; border: 2px solid #eee; 
            display: flex; items-center; justify-center; transition: 0.3s;
        }

        /* Ø´Ø±ÙŠØ· Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø³ÙÙ„ÙŠ Ø§Ù„ÙØ§Ø®Ø± */
        .bottom-bar { 
            background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(20px);
            border-top: 1px solid rgba(0,0,0,0.05); box-shadow: 0 -10px 50px rgba(0,0,0,0.1);
        }

        .price-badge { background: var(--main); color: white; padding: 5px 15px; border-radius: 12px; font-size: 0.7rem; font-weight: 900; }
    </style>
</head>
<body class="pb-48">

    <header class="hero-box pt-16 pb-24 text-center text-white">
        <h1 id="title" class="text-3xl font-black mb-2">Ø¥Ø¶Ø§ÙØ§Øª Ø§Ù„Ø­ÙˆØª Ø§Ù„Ù…Ù„ÙƒÙŠØ©</h1>
        <p id="desc" class="text-sm opacity-60">Ø®ØµØµ Ø±Ø­Ù„ØªÙƒ Ø¨Ù…Ø§ ÙŠÙ†Ø§Ø³Ø¨ Ø§Ø­ØªÙŠØ§Ø¬Ø§ØªÙƒ</p>
    </header>

    <main class="max-w-xl mx-auto px-5 -mt-12">
        
        <div id="addonsContainer" class="space-y-4">
            </div>

        <div id="weddingSection" class="hidden mt-10 bg-white p-8 rounded-[3rem] shadow-xl text-center border-t-4 border-[#D4AF37]">
            <h3 class="font-black text-lg mb-4">ğŸ¨ Ø§Ø®ØªØ± Ù„ÙˆÙ† ØªØ²ÙŠÙŠÙ† Ø§Ù„Ù…ÙˆÙƒØ¨</h3>
            <div class="flex justify-center gap-6">
                <div onclick="selectColor('Ø£Ø¨ÙŠØ¶', this)" class="w-12 h-12 rounded-full border-4 border-[#D4AF37] bg-white cursor-pointer transition-all active:scale-90"></div>
                <div onclick="selectColor('Ø£Ø­Ù…Ø±', this)" class="w-12 h-12 rounded-full border-4 border-white bg-red-600 cursor-pointer transition-all active:scale-90"></div>
                <div onclick="selectColor('Ø°Ù‡Ø¨ÙŠ', this)" class="w-12 h-12 rounded-full border-4 border-white bg-yellow-400 cursor-pointer transition-all active:scale-90"></div>
            </div>
            <p id="colorLabel" class="mt-3 text-xs font-black text-gray-400">Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ù…Ø®ØªØ§Ø±: Ø£Ø¨ÙŠØ¶</p>
        </div>

    </main>

    <div class="fixed bottom-0 left-0 right-0 bottom-bar p-6 z-50 rounded-t-[3rem]">
        <div class="max-w-xl mx-auto flex items-center justify-between">
            <div>
                <div class="price-badge mb-1">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ</div>
                <div class="flex items-baseline gap-1">
                    <span id="totalPrice" class="text-4xl font-black text-[#002349]">0</span>
                    <span class="text-xs font-bold text-gray-400 text-right">Ø¯.Ø¹</span>
                </div>
            </div>
            <button onclick="saveAndNext()" class="bg-[#D4AF37] text-[#002349] px-10 py-5 rounded-[2rem] font-black text-xl shadow-lg active:scale-95 transition-all flex items-center gap-3">
                ØªØ£ÙƒÙŠØ¯ <i class="fas fa-arrow-left"></i>
            </button>
        </div>
    </div>

    <script>
        const params = new URLSearchParams(window.location.search);
        const type = params.get('type') || 'personal';
        const basePrice = parseInt(params.get('price') || 0);
        let selectedAddons = [];
        let selectedColor = "Ø£Ø¨ÙŠØ¶";

        // Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ§Øª
        const addonData = [
            { id: 'driver', name: 'Ø³Ø§Ø¦Ù‚ Ø®Ø§Øµ', price: 25000, icon: 'fa-user-tie' },
            { id: 'baby', name: 'ÙƒØ±Ø³ÙŠ Ø£Ø·ÙØ§Ù„', price: 10000, icon: 'fa-baby' },
            { id: 'delivery', name: 'ØªÙˆØµÙŠÙ„ Ù„Ù„Ù…Ù†Ø²Ù„', price: 15000, icon: 'fa-home' }
        ];

        // Ø¥Ø¶Ø§ÙØ© Ø¨Ø§Ù‚Ø© Ø§Ù„Ø¹Ø±Ø³ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù†ÙˆØ¹ Ø²ÙØ§Ù
        if(type === 'wedding') {
            addonData.push({ id: 'wedding_pack', name: 'Ø¨Ø§Ù‚Ø© Ø§Ù„ØªØ²ÙŠÙŠÙ† Ø§Ù„ÙƒØ§Ù…Ù„Ø©', price: 50000, icon: 'fa-ring' });
            document.getElementById('weddingSection').classList.remove('hidden');
            document.getElementById('title').innerText = "ØªØ¬Ù‡ÙŠØ²Ø§Øª Ø§Ù„Ø¹Ø±Ø³ Ø§Ù„Ù…Ù„ÙƒÙŠØ©";
        }

        function render() {
            const container = document.getElementById('addonsContainer');
            container.innerHTML = addonData.map(item => `
                <div onclick="toggleAddon('${item.id}', ${item.price}, this)" class="addon-card p-6 flex items-center justify-between">
                    <div class="flex items-center gap-4">
                        <div class="w-14 h-14 bg-slate-50 rounded-2xl flex items-center justify-center text-xl text-[#002349]">
                            <i class="fas ${item.icon}"></i>
                        </div>
                        <div>
                            <h4 class="font-black">${item.name}</h4>
                            <span class="text-xs text-[#D4AF37] font-bold">+ ${item.price.toLocaleString()} Ø¯.Ø¹</span>
                        </div>
                    </div>
                    <div class="check-box">
                        <i class="fas fa-check text-xs"></i>
                    </div>
                </div>
            `).join('');
        }

        function toggleAddon(id, price, el) {
            const index = selectedAddons.findIndex(a => a.id === id);
            if(index > -1) {
                selectedAddons.splice(index, 1);
                el.classList.remove('selected');
            } else {
                const name = el.querySelector('h4').innerText;
                selectedAddons.push({ id, price, name });
                el.classList.add('selected');
            }
            calculate();
        }

        function calculate() {
            const addonsTotal = selectedAddons.reduce((sum, a) => sum + a.price, 0);
            const final = basePrice + addonsTotal;
            document.getElementById('totalPrice').innerText = final.toLocaleString();
            params.set('final_price', final);
        }

        function selectColor(color, el) {
            selectedColor = color;
            document.querySelectorAll('#weddingSection div.rounded-full').forEach(d => d.style.borderColor = 'white');
            el.style.borderColor = '#D4AF37';
            document.getElementById('colorLabel').innerText = "Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ù…Ø®ØªØ§Ø±: " + color;
        }

        function saveAndNext() {
            const names = selectedAddons.map(a => a.name).join(' + ');
            params.set('addons', names || 'Ø¨Ø¯ÙˆÙ† Ø¥Ø¶Ø§ÙØ§Øª');
            if(type === 'wedding') params.set('wedding_color', selectedColor);

            // Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„ØµÙØ­Ø© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø²Ø¨ÙˆÙ†
            const target = (type === 'wedding') ? 'booking_wedding.html' : 'booking_personal.html';
            window.location.href = target + '?' + params.toString();
        }

        window.onload = render;
    </script>
</body>
</html>
