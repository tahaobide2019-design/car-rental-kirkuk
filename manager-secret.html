<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>ุฅุฏุงุฑุฉ ุงูุญูุช | ุงููุฏูุฑ ๐</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@700;900&display=swap" rel="stylesheet">
</head>
<body class="bg-slate-900 text-white font-['Tajawal'] p-6">
    <header class="flex justify-between items-center mb-10 border-b border-white/10 pb-6">
        <h1 class="text-2xl font-black text-[#D4AF37]">ุทูุจุงุช ุงูุฅูุบุงุก ุงููุนููุฉ ๐จ</h1>
        <button onclick="loadAdminData()" class="bg-blue-600 px-4 py-2 rounded-xl text-xs font-bold">ุชุญุฏูุซ ุงููุงุฆูุฉ</button>
    </header>

    <div id="adminArea" class="grid gap-4"></div>

    <script>
        const scriptURL = "https://script.google.com/macros/s/AKfycbzP18ey_neMD-NMnB8YZQIJ5OhH7Val9NwVfn_XWbv9qVFpMKGximwr5hE6MN4NmXY0YQ/exec";

        async function loadAdminData() {
            document.getElementById('adminArea').innerHTML = "ุฌุงุฑู ุงูุชุญููู...";
            const res = await fetch(`${scriptURL}?action=getAllOrders`);
            const orders = await res.json();
            const pending = orders.filter(o => o.status === "ูุทููุจ ุฅูุบุงุก โ๏ธ");
            
            let html = '';
            pending.forEach(o => {
                html += `
                <div class="bg-slate-800 p-6 rounded-[2rem] border-r-8 border-orange-500 shadow-2xl">
                    <div class="mb-4">
                        <span class="text-orange-400 font-bold">ุงูููุชุจ: ${o.claimedBy}</span>
                        <h3 class="text-xl font-black mt-1">${o.car} (${o.province})</h3>
                    </div>
                    <div class="flex gap-3">
                        <button onclick="handle('adminReset', '${o.id}')" class="flex-1 bg-green-700 py-4 rounded-2xl font-black text-xs hover:bg-green-600 transition-all">ุฅุนุงุฏุฉ ุชูุนูู ุงูุทูุจ (ูููู)</button>
                        <button onclick="handle('adminDelete', '${o.id}')" class="flex-1 bg-red-700 py-4 rounded-2xl font-black text-xs hover:bg-red-600 transition-all">ุญุฐู ุงูุทูุจ ููุงุฆูุงู</button>
                    </div>
                </div>`;
            });
            document.getElementById('adminArea').innerHTML = html || '<p class="text-center opacity-30 mt-20">ูุง ุชูุฌุฏ ุทูุจุงุช ุฅูุบุงุก ุชุญุชุงุฌ ูููุงููุชู.</p>';
        }

        async function handle(action, id) {
            const confirmMsg = action === 'adminReset' ? "ูู ุชุฑูุฏ ุฅุนุงุฏุฉ ุงูุทูุจ ูุฌุฏูุฏ ูุฌููุน ุงูููุงุชุจุ" : "ูู ุชุฑูุฏ ุญุฐู ุงูุทูุจ ุชูุงูุงูุ";
            if(confirm(confirmMsg)) {
                await fetch(`${scriptURL}?action=${action}&id=${id}`);
                alert("ุชู ุชูููุฐ ุงููุฑุงุฑ");
                loadAdminData();
            }
        }
        window.onload = loadAdminData;
    </script>
</body>
</html>

