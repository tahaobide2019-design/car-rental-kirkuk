<!DOCTYPE html>
<html lang="ar" dir="rtl" id="htmlTag">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø·Ù„Ø¨ | Ø§Ù„Ø­ÙˆØª ğŸ‹</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { --main: #002349; --accent: #D4AF37; }
        body { font-family: 'Tajawal', sans-serif; background-color: #f0f4f8; overflow-x: hidden; }
        
        .main-card {
            background: white; border-radius: 3.5rem;
            box-shadow: 0 25px 50px -12px rgba(0, 35, 73, 0.15);
            border-top: 12px solid var(--main);
            animation: slideUp 0.6s ease-out;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .info-grid {
            display: grid; grid-template-columns: repeat(2, 1fr); gap: 0.75rem;
        }

        .info-item {
            background: #f8fafc; padding: 0.75rem; border-radius: 1.2rem;
            border: 1px solid #edf2f7; display: flex; flex-direction: column;
        }

        .info-label { color: #94a3b8; font-size: 0.65rem; font-weight: 800; margin-bottom: 2px; }
        .info-value { color: var(--main); font-size: 0.85rem; font-weight: 900; }

        .price-summary {
            background: var(--main); color: var(--accent);
            border-radius: 2.5rem; padding: 1.5rem;
            position: relative; overflow: hidden;
        }

        .btn-confirm {
            background: var(--main); color: white;
            box-shadow: 0 15px 30px rgba(0, 35, 73, 0.3);
            transition: 0.3s;
        }
        .btn-confirm:active { transform: scale(0.96); }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

    <div id="mainBox" class="max-w-md w-full main-card p-6 md:p-8">
        
        <div class="text-center mb-6">
            <div id="mainEmoji" class="text-5xl mb-2">ğŸ“‹</div>
            <h1 id="pageTitle" class="text-2xl font-black" style="color: var(--main);">Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø·Ù„Ø¨</h1>
            <p id="pageSub" class="text-slate-400 text-[10px] font-bold tracking-widest uppercase">Review Details</p>
        </div>

        <div id="detailsGrid" class="info-grid mb-6">
            </div>

        <div class="price-summary text-center shadow-xl mb-6">
            <p id="totalLabel" class="text-[10px] font-black opacity-70 uppercase mb-1">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„ØªÙ‚Ø±ÙŠØ¨ÙŠ</p>
            <div class="text-3xl font-black">
                <span id="totalVal">0</span> <small class="text-sm font-bold" id="currLabel">Ø¯.Ø¹</small>
            </div>
        </div>

        <div class="space-y-3">
            <button onclick="confirmAndSubmit()" class="btn-confirm w-full py-5 rounded-2xl font-black text-xl flex items-center justify-center gap-3">
                <span id="btnSubmit">ØªØ£ÙƒÙŠØ¯ ÙˆØ·Ù„Ø¨</span>
                <i class="fas fa-check-circle"></i>
            </button>
            
            <button onclick="window.history.back()" class="w-full text-slate-400 font-black text-xs hover:text-red-500 transition-all">
                <i class="fas fa-edit ml-1"></i> <span id="btnBack">ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</span>
            </button>
        </div>
    </div>

    <script>
        const u = new URLSearchParams(window.location.search);
        const type = u.get('type') || 'personal';
        const lang = u.get('lang') || 'ar';

        const configs = {
            training: { main: '#7c3aed', accent: '#ffffff', emoji: 'ğŸ“' },
            wedding: { main: '#be185d', accent: '#ffffff', emoji: 'ğŸ’' },
            personal: { main: '#002349', accent: '#D4AF37', emoji: 'ğŸš—' }
        };

        const uiContent = {
            ar: { title: "Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„ØªÙØ§ØµÙŠÙ„", total: "Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªÙ‚Ø±ÙŠØ¨ÙŠ", btn: "ØªØ£ÙƒÙŠØ¯ ÙˆØ·Ù„Ø¨", back: "Ø±Ø¬ÙˆØ¹ Ù„Ù„ØªØ¹Ø¯ÙŠÙ„", curr: "Ø¯.Ø¹", 
                fields: { name: "Ø§Ù„Ø§Ø³Ù…", phone: "Ø§Ù„Ù‡Ø§ØªÙ", age: "Ø§Ù„Ø¹Ù…Ø±", city: "Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©", prov: "Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©", car: "Ø§Ù„Ø³ÙŠØ§Ø±Ø©", addons: "Ø§Ù„Ø¥Ø¶Ø§ÙØ§Øª", addon_name: "Ø§Ù„Ø¥Ø¶Ø§ÙØ§Øª", days: "Ø§Ù„Ù…Ø¯Ø©", gender: "Ø§Ù„Ø¬Ù†Ø³", license: "Ø§Ù„Ø¥Ø¬Ø§Ø²Ø©" } },
            ku: { title: "Ù¾ÛŒØ§Ú†ÙˆÙˆÙ†Û•ÙˆÛ•ÛŒ ÙˆØ±Ø¯Û•Ú©Ø§Ø±ÛŒÛŒÛ•Ú©Ø§Ù†", total: "Ú©Û†ÛŒ Ú¯Ø´ØªÛŒ Ø®Û•Ù…ÚµÛÙ†Ø±Ø§Ùˆ", btn: "Ù¾Ø´ØªÚ•Ø§Ø³ØªÚ©Ø±Ø¯Ù†Û•ÙˆÛ•", back: "Ú¯Û•Ú•Ø§Ù†Û•ÙˆÛ• Ø¨Û† Ø¯Û•Ø³ØªÚ©Ø§Ø±ÛŒ", curr: "Ø¯.Ø¹",
                fields: { name: "Ù†Ø§Ùˆ", phone: "ØªÛ•Ù„Û•ÙÛ†Ù†", age: "ØªÛ•Ù…Û•Ù†", city: "Ø´Ø§Ø±", prov: "Ø´Ø§Ø±", car: "Ø¦Û†ØªÛ†Ù…Ø¨ÛÙ„", addons: "Ø²ÛŒØ§Ø¯Ú©Ø±Ø§ÙˆÛ•Ú©Ø§Ù†", addon_name: "Ø²ÛŒØ§Ø¯Ú©Ø±Ø§ÙˆÛ•Ú©Ø§Ù†", days: "Ù…Ø§ÙˆÛ•", gender: "Ú•Û•Ú¯Û•Ø²", license: "Ù…Û†ÚµÛ•Øª" } },
            en: { title: "Review Details", total: "Approximate Total Price", btn: "Confirm & Order", back: "Back to Edit", curr: "IQD",
                fields: { name: "Name", phone: "Phone", age: "Age", city: "City", prov: "City", car: "Car", addons: "Addons", addon_name: "Addons", days: "Days", gender: "Gender", license: "License" } },
            tr: { title: "DetaylarÄ± Ä°ncele", total: "Tahmini Toplam Tutar", btn: "Onayla ve SipariÅŸ Et", back: "DÃ¼zenlemeye DÃ¶n", curr: "IQD",
                fields: { name: "Ä°sim", phone: "Telefon", age: "YaÅŸ", city: "Åehir", prov: "Åehir", car: "AraÃ§", addons: "Ekstralar", addon_name: "Ekstralar", days: "GÃ¼n", gender: "Cinsiyet", license: "Ehliyet" } }
        };

        const toScriptMap = {
            "Kirkuk": "ÙƒØ±ÙƒÙˆÙƒ", "KerkÃ¼k": "ÙƒØ±ÙƒÙˆÙƒ", "Ú©Û•Ø±Ú©ÙˆÚ©": "ÙƒØ±ÙƒÙˆÙƒ",
            "Baghdad": "Ø¨ØºØ¯Ø§Ø¯", "BaÄŸdat": "Ø¨ØºØ¯Ø§Ø¯", "Ø¨Û•ØºØ¯Ø§": "Ø¨ØºØ¯Ø§Ø¯",
            "personal": "ØªØ£Ø¬ÙŠØ± Ø´Ø®ØµÙŠ", "wedding": "Ø£Ø¹Ø±Ø§Ø³ ÙˆÙ…Ù†Ø§Ø³Ø¨Ø§Øª", "training": "ØªØ¹Ù„ÙŠÙ… Ù‚ÙŠØ§Ø¯Ø©",
            "Male": "Ø°ÙƒØ±", "Erkek": "Ø°ÙƒØ±", "Ù†ÛØ±": "Ø°ÙƒØ±",
            "Female": "Ø£Ù†Ø«Ù‰", "KadÄ±n": "Ø£Ù†Ø«Ù‰", "Ù…Û": "Ø£Ù†Ø«Ù‰"
        };

        window.onload = () => {
            const t = configs[type] || configs.personal;
            const ui = uiContent[lang] || uiContent.ar;
            
            document.documentElement.style.setProperty('--main', t.main);
            document.documentElement.style.setProperty('--accent', t.accent);
            document.getElementById('mainEmoji').innerText = t.emoji;
            document.getElementById('pageTitle').innerText = ui.title;
            document.getElementById('totalLabel').innerText = ui.total;
            document.getElementById('btnSubmit').innerText = ui.btn;
            document.getElementById('btnBack').innerText = ui.back;
            document.getElementById('currLabel').innerText = ui.curr;
            document.getElementById('htmlTag').dir = (lang === 'en' || lang === 'tr') ? 'ltr' : 'rtl';

            let gridHtml = '';
            // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¨Ø´ÙƒÙ„ Ù…ØµÙÙˆÙØ© Ù…Ø±ØªØ¨Ø©
            Object.keys(ui.fields).forEach(key => {
                let val = u.get(key);
                if (val && val !== 'null' && val !== '---') {
                    gridHtml += `
                        <div class="info-item">
                            <span class="info-label">${ui.fields[key]}</span>
                            <span class="info-value">${val}</span>
                        </div>`;
                }
            });
            document.getElementById('detailsGrid').innerHTML = gridHtml;

            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø¹Ø±
            const p1 = parseInt(u.get('price') || 0);
            const p2 = parseInt(u.get('addon_price') || 0);
            document.getElementById('totalVal').innerText = (p1 + p2).toLocaleString();
        };

        function confirmAndSubmit() {
            const p1 = parseInt(u.get('price') || 0);
            const p2 = parseInt(u.get('addon_price') || 0);
            
            u.set('total_final', p1 + p2);
            
            // Ø§Ù„Ù…ØªØ±Ø¬Ù… Ø§Ù„ØµØ§Ù…Øª Ù‚Ø¨Ù„ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„ØµÙØ­Ø© Ø§Ù„Ù†Ø¬Ø§Ø­
            if (u.has('city')) u.set('city', toScriptMap[u.get('city')] || u.get('city'));
            if (u.has('gender')) u.set('gender', toScriptMap[u.get('gender')] || u.get('gender'));
            
            window.location.href = `success.html?${u.toString()}`;
        }
    </script>
</body>
</html>
