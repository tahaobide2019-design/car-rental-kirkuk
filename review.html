<!DOCTYPE html>
<html lang="ar" dir="rtl" id="htmlTag">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title id="docTitle">Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø·Ù„Ø¨ | Ø§Ù„Ø­ÙˆØª ğŸ‹</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&family=Poppins:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { --main: #002349; --accent: #D4AF37; }
        body { font-family: 'Tajawal', 'Poppins', sans-serif; background-color: #f0f4f8; overflow-x: hidden; }
        .main-card { background: white; border-radius: 3.5rem; box-shadow: 0 25px 50px -12px rgba(0, 35, 73, 0.15); border-top: 12px solid var(--main); animation: slideUp 0.6s ease-out; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        .info-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 0.75rem; }
        .info-item { background: #f8fafc; padding: 0.75rem; border-radius: 1.2rem; border: 1px solid #edf2f7; display: flex; flex-direction: column; }
        .info-label { color: #94a3b8; font-size: 0.65rem; font-weight: 800; margin-bottom: 2px; text-transform: uppercase; }
        .info-value { color: var(--main); font-size: 0.85rem; font-weight: 900; }
        .price-summary { background: var(--main); color: var(--accent); border-radius: 2.5rem; padding: 1.5rem; position: relative; overflow: hidden; }
        .btn-confirm { background: var(--main); color: white; box-shadow: 0 15px 30px rgba(0, 35, 73, 0.3); transition: 0.3s; }
        .btn-confirm:active { transform: scale(0.96); }
        .map-badge { background: #e2e8f0; color: #475569; padding: 8px 15px; border-radius: 12px; font-size: 11px; display: inline-flex; align-items: center; gap: 6px; margin-top: 5px; font-weight: bold; }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

    <div id="mainBox" class="max-w-md w-full main-card p-6 md:p-8">
        <div class="text-center mb-6">
            <div id="mainEmoji" class="text-5xl mb-2">ğŸ“‹</div>
            <h1 id="pageTitle" class="text-2xl font-black" style="color: var(--main);">---</h1>
            <p id="pageSub" class="text-slate-400 text-[10px] font-bold tracking-widest uppercase italic">Order Verification</p>
        </div>

        <div id="detailsGrid" class="info-grid mb-4"></div>

        <div id="locationPreview" class="mb-6 text-center hidden">
             <a id="mapLink" href="#" target="_blank" class="map-badge hover:bg-slate-200 transition-all">
                <i class="fas fa-map-marker-alt"></i> <span id="mapText">Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø©</span>
             </a>
        </div>

        <div class="price-summary text-center shadow-xl mb-6">
            <p id="totalLabel" class="text-[10px] font-black opacity-70 uppercase mb-1">---</p>
            <div class="text-3xl font-black"><span id="totalVal">0</span> <small class="text-sm font-bold" id="currLabel">---</small></div>
        </div>

        <div class="space-y-3">
            <button onclick="confirmAndSubmit()" class="btn-confirm w-full py-5 rounded-2xl font-black text-xl flex items-center justify-center gap-3">
                <span id="btnSubmit">---</span>
                <i class="fas fa-check-circle"></i>
            </button>
            <button onclick="window.history.back()" class="w-full text-slate-400 font-black text-xs hover:text-red-500 transition-all">
                <i class="fas fa-edit ml-1"></i> <span id="btnBack">---</span>
            </button>
        </div>
    </div>

    <script>
        const u = new URLSearchParams(window.location.search);
        const type = u.get('type') || 'personal';
        const lang = u.get('lang') || 'ar';

        const configs = {
            training: { main: '#7c3aed', accent: '#ffffff', emoji: 'ğŸ“' },
            wedding: { main: '#be185d', accent: '#ffffff', emoji: 'ğŸ’' },
            personal: { main: '#002349', accent: '#D4AF37', emoji: 'ğŸš—' }
        };

        const uiContent = {
            ar: { 
                title: "Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„ØªÙØ§ØµÙŠÙ„", total: "Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„ØªÙ‚Ø±ÙŠØ¨ÙŠ", btn: "ØªØ£ÙƒÙŠØ¯ ÙˆØ¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨", back: "Ø±Ø¬ÙˆØ¹ Ù„Ù„ØªØ¹Ø¯ÙŠÙ„", curr: "Ø¯.Ø¹", map: "Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…Ø®ØªØ§Ø±",
                fields: { name: "Ø§Ù„Ø§Ø³Ù…", phone: "Ø§Ù„Ù‡Ø§ØªÙ", age: "Ø§Ù„Ø¹Ù…Ø±", province: "Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©", car: "Ø§Ù„Ø®Ø¯Ù…Ø©/Ø§Ù„Ø³ÙŠØ§Ø±Ø©", addon_display: "Ø§Ù„Ø¥Ø¶Ø§ÙØ§Øª", date: "Ø§Ù„ØªØ§Ø±ÙŠØ®", gender: "Ø§Ù„Ø¬Ù†Ø³", license_no: "Ø±Ù‚Ù… Ø§Ù„Ø¥Ø¬Ø§Ø²Ø©", national_id: "Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ©" } 
            },
            ku: { 
                title: "Ù¾ÛŒØ§Ú†ÙˆÙˆÙ†Û•ÙˆÛ•ÛŒ ÙˆØ±Ø¯Û•Ú©Ø§Ø±ÛŒÛŒÛ•Ú©Ø§Ù†", total: "Ú©Û†ÛŒ Ú¯Ø´ØªÛŒ Ø®Û•Ù…ÚµÛÙ†Ø±Ø§Ùˆ", btn: "Ù¾Ø´ØªÚ•Ø§Ø³ØªÚ©Ø±Ø¯Ù†Û•ÙˆÛ• Ùˆ Ù†Ø§Ø±Ø¯Ù†", back: "Ú¯Û•Ú•Ø§Ù†Û•ÙˆÛ• Ø¨Û† Ø¯Û•Ø³ØªÚ©Ø§Ø±ÛŒ", curr: "Ø¯.Ø¹", map: "Ø¨ÛŒÙ†ÛŒÙ†ÛŒ Ø´ÙˆÛÙ† Ù„Û•Ø³Û•Ø± Ù†Û•Ø®Ø´Û•",
                fields: { name: "Ù†Ø§Ùˆ", phone: "ØªÛ•Ù„Û•ÙÛ†Ù†", age: "ØªÛ•Ù…Û•Ù†", province: "Ø´Ø§Ø±", car: "Ø¦Û†ØªÛ†Ù…Ø¨ÛÙ„/Ø®Ø²Ù…Û•ØªÚ¯ÙˆØ²Ø§Ø±ÛŒ", addon_display: "Ø²ÛŒØ§Ø¯Ú©Ø±Ø§ÙˆÛ•Ú©Ø§Ù†", date: "Ø¨Û•Ø±ÙˆØ§Ø±", gender: "Ú•Û•Ú¯Û•Ø²", license_no: "Ú˜. Ù…Û†ÚµÛ•Øª", national_id: "Ú˜. Ù†Ø§Ø³Ù†Ø§Ù…Û•" } 
            },
            tr: { 
                title: "DetaylarÄ± Ä°ncele", total: "Tahmini Toplam Tutar", btn: "Onayla ve GÃ¶nder", back: "DÃ¼zenlemek Ä°Ã§in Geri DÃ¶n", curr: "IQD", map: "Haritada GÃ¶rÃ¼ntÃ¼le",
                fields: { name: "Ad Soyad", phone: "Telefon", age: "YaÅŸ", province: "Åehir", car: "AraÃ§/Servis", addon_display: "Ekstralar", date: "Tarih", gender: "Cinsiyet", license_no: "Ehliyet No", national_id: "Kimlik No" } 
            },
            en: { 
                title: "Review Details", total: "Approximate Total Amount", btn: "Confirm & Send Order", back: "Back to Edit", curr: "IQD", map: "View Location on Map",
                fields: { name: "Full Name", phone: "Phone", age: "Age", province: "City", car: "Car/Service", addon_display: "Add-ons", date: "Date", gender: "Gender", license_no: "License No", national_id: "ID Number" } 
            }
        };

        window.onload = () => {
            const t = configs[type] || configs.personal;
            const ui = uiContent[lang] || uiContent.ar;
            const isRtl = (lang === 'ar' || lang === 'ku');
            
            document.documentElement.style.setProperty('--main', t.main);
            document.documentElement.style.setProperty('--accent', t.accent);
            document.getElementById('mainEmoji').innerText = t.emoji;
            document.getElementById('pageTitle').innerText = ui.title;
            document.getElementById('totalLabel').innerText = ui.total;
            document.getElementById('btnSubmit').innerText = ui.btn;
            document.getElementById('btnBack').innerText = ui.back;
            document.getElementById('currLabel').innerText = ui.curr;
            document.getElementById('mapText').innerText = ui.map;
            document.getElementById('htmlTag').dir = isRtl ? 'rtl' : 'ltr';

            let gridHtml = '';
            Object.keys(ui.fields).forEach(key => {
                let val = u.get(key);
                if (val && val !== 'null' && val !== '---' && val !== 'undefined') {
                    gridHtml += `<div class="info-item"><span class="info-label">${ui.fields[key]}</span><span class="info-value">${val}</span></div>`;
                }
            });
            document.getElementById('detailsGrid').innerHTML = gridHtml;

            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ
            const price = parseInt(u.get('price') || 0);
            const addonPrice = parseInt(u.get('addon_price') || 0);
            const total = price + addonPrice;
            document.getElementById('totalVal').innerText = total.toLocaleString();

            if (u.get('location_link')) {
                document.getElementById('locationPreview').classList.remove('hidden');
                document.getElementById('mapLink').href = u.get('location_link');
            }
        };

        function confirmAndSubmit() {
            // Ù†Ù‚ÙˆÙ… Ø¨ØªÙ…Ø±ÙŠØ± ÙƒØ§ÙØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ ØµÙØ­Ø© Ø§Ù„Ù†Ø¬Ø§Ø­ Ø£Ùˆ Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            const finalPrice = parseInt(u.get('price') || 0) + parseInt(u.get('addon_price') || 0);
            u.set('total_final', finalPrice);
            
            // Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø¥Ù„Ù‰ ØµÙØ­Ø© Ø§Ù„Ù†Ø¬Ø§Ø­ (Ø§Ù„ØªÙŠ Ø³ØªÙ‚ÙˆÙ… Ø¨Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙØ¹Ù„ÙŠØ§Ù‹ Ù„Ù„Ø³ÙƒØ±ÙŠØ¨Øª)
            window.location.href = `success.html?${u.toString()}`;
        }
    </script>
</body>
</html>
